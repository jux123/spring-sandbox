# spring-sandbox

Generated by
```
https://start.spring.io/#!type=gradle-project-kotlin&language=java&platformVersion=3.5.4&packaging=jar&jvmVersion=21&groupId=com.sandbox&artifactId=sandbox&name=sandbox&description=Spring%20testing%20sandbox&packageName=com.sandbox.sandbox&dependencies=web,postgresql,devtools,flyway,data-jdbc,actuator,kafka
```

## Run DB
```
docker run -p 15432:5432 -e POSTGRES_USER=cdr_user -e POSTGRES_PASSWORD=pass -e POSTGRES_DB=cdr postgres:17.2-alpine
```
With persistant tables
```
docker run --name cdr-postgres \
    -p 5432:5432 \
    -e POSTGRES_USER=cdr_user \
    -e POSTGRES_PASSWORD=pass \
    -e POSTGRES_DB=cdr \
    -v /home/juhan/.local/share/postgresql/cdr/data:/var/lib/postgresql/data \
    -d postgres:17.2-alpine
```

## Run App
Run with gradle <br>
`./gradlew bootRun` <br>
`./gradlew bootRun --args='--spring.profiles.active=local'` <br>
Note that with Spring Boot devTools dependency, the application will restart (reloads spring context) itself when code changes. <br>
TODO: check how it works only on localhost and not final build

Alternatively you can run so, which will build rebuild and restart jvm on every file change which is more reliable especially with AOT compilation <br>
`./gradlew bootRun -t` <br>

## Gradle commands
Show which tasks get run <br>
`./gradlew --console verbose build`

Show all tasks for project <br>
`./gradlew tasks`

Show dependencies <br>
`./gradlew dependencies`


## OpenAPI UI
`http://localhost:8080/swagger-ui/index.html`


## Testing

### Integration tests
Integration tests are run with Testcontainers, which requires Docker to be running. <br>

Run integration tests with <br>
`./gradlew test -PintegrationTest=true`

Regular tests are run with, that skip slow integration tests <br>
`./gradlew test`